!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}({2:function(e,t,i){"use strict";i.r(t);function*n(e,t,i){let n=e;for(void 0===i&&(i=1);n<t;)yield n,n+=i}function o(e,t){return e.slice(9*t,9*t+9)}function s(e,t){return Array.from(n(0,9)).map((function(i){return e[9*i+t]})).join("")}function r(e,t,i){let o=3*Math.floor(t/3),s=3*Math.floor(i/3);return Array.from(n(s,s+3)).map((function(t){return e.slice(9*t+o,9*t+o+3)})).join("")}function*l(e){for(let t=0;t<9;t+=1)yield o(e,t)}function*c(e){for(let t=0;t<9;t+=1)yield s(e,t)}function*a(e){for(let t=0;t<9;t+=1){let i=3*Math.floor(t/3),n=t%3*3;yield r(e,n,i)}}function h(e){return Array.from(l(e)).every(g)&&Array.from(c(e)).every(g)&&Array.from(a(e)).every(g)}function d(e,t){var i=new Set(e);for(var n of t)i.delete(n);return i}const u=Array.from(n(1,10)).map(e=>e.toString());function f(e,t,i){return d(d(d(u,new Set(o(e,i))),new Set(s(e,t))),new Set(r(e,t,i)))}class m extends Error{constructor(e){super(e),this.name="ItemError"}}function g(e){if(9!==e.length)throw new m(`Item '${e}' has a length not equal to 9`);let t=new Set(e);return u.every(e=>t.has(e))}const p=new Set(u);function*y(e,t){const i=e.length;for(let n=t||0;n<i;n+=1){let t=e[n];if(p.has(t))continue;let i=n%9,o=Math.floor(n/9),s=Array.from(f(e,i,o));if(0===s.length)return;for(let t of s){let i=e.slice(0,n)+t+e.slice(n+1);for(let e of y(i))yield e}return}h(e)&&(yield e)}var b=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{c(n.next(e))}catch(e){s(e)}}function l(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,l)}c((n=n.apply(e,t||[])).next())}))};const v=" ".repeat(81),w=["1","2","3","4","5","6","7","8","9"],E=w.length;class L extends Error{constructor(){super(...arguments),this.message="Maximum number of attempts reached"}}class A{constructor(e){console.log("INIT");const t=e.querySelector(".title"),i=e.querySelector(".game"),n=e.querySelector(".controls");this.game="                            LOADING    ...                                       ",this.elements=this.game.split("").map(this.generateElement.bind(this)),this.updateElementAttributes();for(let e of this.elements)i.appendChild(e);this.drawGame();let o=e.offsetHeight-t.offsetHeight-n.offsetHeight,s=i.offsetWidth,r=Math.min(s,o);i.style.height=r+"px",i.style.width=r+"px",i.addEventListener("keyup",this.setFieldValueViaKeyboard.bind(this)),n.style.flexGrow="1",n.querySelectorAll("button[value]").forEach(e=>{e.addEventListener("click",this.setFieldValueViaButton.bind(this))}),n.querySelector("button.btn-fullscreen").addEventListener("click",(function(e){document.documentElement.requestFullscreen()})),n.querySelector("button.btn-check").addEventListener("click",this.checkGame.bind(this)),this.controls=n.querySelectorAll("button[value]"),this.solution=v,this.selectFieldListener=this.selectField.bind(this),this.selectedElement=0}check_incomplete_item(e){let t=Array.from(e).reduce((e,t)=>(" "!==t?e.set(t,(e.get(t)||0)+1):e.set(t,1),e),new Map);return Array.from(t.values()).every(e=>1===e)}init(){return b(this,void 0,void 0,(function*(){let e,t,i=0;do{t=!1,e=this.randomize(v,4,new Set),i+=1;for(let i of l(e))t=t||!1===this.check_incomplete_item(i);for(let i of c(e))t=t||!1===this.check_incomplete_item(i);for(let i of a(e))t=t||!1===this.check_incomplete_item(i)}while(t&&i<1e3);if(i>=1e3){for(let t of l(e))console.log(t,this.check_incomplete_item(t));for(let t of c(e))console.log(t,this.check_incomplete_item(t));for(let t of a(e))console.log(t,this.check_incomplete_item(t));throw console.log(e.slice(0,9).replace(/\s/g,".")),console.log(e.slice(9,18).replace(/\s/g,".")),console.log(e.slice(18,27).replace(/\s/g,".")),console.log(e.slice(27,36).replace(/\s/g,".")),console.log(e.slice(36,45).replace(/\s/g,".")),console.log(e.slice(45,54).replace(/\s/g,".")),console.log(e.slice(54,63).replace(/\s/g,".")),console.log(e.slice(63,72).replace(/\s/g,".")),console.log(e.slice(72,81).replace(/\s/g,".")),new L}let n=y(e,0);this.solution=n.next().value,console.log("Got game");try{this.game=this.clearSomeFields(this.solution,50)}catch(e){}console.log("Removed fields"),this.selectedElement=this.game.indexOf(" "),this.updateElementAttributes(),this.drawGame()}))}getXfromPosition(e){return e%E}getYfromPosition(e){return Math.floor(e/E)}clearSomeFields(e,t){let i,n=!0,o=new Set,s=0;do{let t,r;do{t=this.getRandomNumber(0,e.length)}while(" "===e[t]&&!1===o.has(t));i=this.replaceAtPosition(this.replaceAtPosition(e,t," "),e.length-t-1," "),r=y(i,0),r.next(),n=!r.next().done,o.add(t),s+=1}while(n&&s<10);if(s>10)throw new L;return t>0?this.clearSomeFields(i,t-2):e}generateElement(e,t){let i=document.createElement("div");return e=e.trim(),i.setAttribute("data-field-index",t.toString()),i.classList.add("input-container"),i}updateElementAttributes(){console.log("updateElementAttributes"),this.game.split("").forEach((e,t)=>{let i=this.elements[t];" "!==e?(i.setAttribute("data-readonly","true"),i.removeAttribute("tabindex"),i.removeEventListener("focus",this.selectFieldListener)):(i.removeAttribute("data-readonly"),i.setAttribute("tabindex","0"),i.addEventListener("focus",this.selectFieldListener))})}checkGame(){this.solution.split("").forEach((e,t)=>{let i=this.elements[t],n=i.innerHTML;n!==e&&" "!==n?i.classList.add("errored"):i.classList.remove("errored")})}drawGame(){console.log("drawGame"),this.game.split("").forEach((e,t)=>{let i=this.elements[t];i.innerHTML!==e&&(i.innerHTML=e)})}occurresOnce(e,t){return 1===(t.match(new RegExp(e,"g"))||"").length}selectField(e){let t=e.target;if(void 0!==this.selectedElement){this.elements[this.selectedElement].classList.remove("selected")}t.classList.add("selected"),this.selectedElement=parseInt(t.getAttribute("data-field-index"),10),this.highlightFields()}highlightFields(){let e=this.game[this.selectedElement];this.elements.forEach(e=>{e.classList.remove("highlighted")})," "!==e&&this.game.split("").forEach((t,i)=>{t===e&&this.elements[i].classList.add("highlighted")})}updateControls(){this.controls.forEach(e=>{let t=e.value;this.game.split(t).length-1==9?(e.classList.remove("btn-outline-info"),e.classList.add("btn-outline-light")):(e.classList.remove("btn-outline-light"),e.classList.add("btn-outline-info"))})}setFieldValue(e){if(void 0===this.selectedElement)return;let t=this.elements[this.selectedElement],i=this.selectedElement,n=!1,l=this.getXfromPosition(i),c=this.getYfromPosition(i);this.game[i]===e&&(e=" "),this.game=this.replaceAtPosition(this.game,i,e)," "!==e?(t.classList.add("filled"),this.occurresOnce(e,s(this.game,l))||(t.classList.add("errored"),n=!0),this.occurresOnce(e,o(this.game,c))||(t.classList.add("errored"),n=!0),this.occurresOnce(e,r(this.game,l,c))||(t.classList.add("errored"),n=!0)):t.classList.remove("filled"),!1===n&&(console.log(n),t.classList.remove("errored")),this.highlightFields(),this.updateControls(),this.drawGame()}setFieldValueViaKeyboard(e){if(w.indexOf(e.key)>=0||"Backspace"===e.key){let t="Backspace"===e.key?" ":e.key;this.setFieldValue(t)}}setFieldValueViaButton(e){let t=e.target.value;this.setFieldValue(t)}randomize(e,t,i){let n;do{n=this.getRandomNumber(0,e.length)}while(!0===i.has(n));i.add(n);let o=this.getRandomNumber(1,9);return t>1?this.randomize(this.replaceAtPosition(e,n,o.toString()),t-1,i):this.replaceAtPosition(e,0,o.toString())}getRandomNumber(e,t){return Math.floor(Math.random()*t+e)}replaceAtPosition(e,t,i){return e.substring(0,t)+i+e.substring(t+1)}}function S(){document.body.style.height=window.innerHeight+"px"}window.addEventListener("resize",S),function(){S();const e=new A(document.body);setTimeout(e.init.bind(e),500)}()}});